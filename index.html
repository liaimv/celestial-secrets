<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Celestial Secrets - A-Frame VR</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fondamento:ital@0;1&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kalnia+Glaze&display=swap" rel="stylesheet">
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <link rel="stylesheet" href="/src/style.css">
</head>
<body>
  <a-scene renderer="antialias: true; colorManagement: true; sortObjects: true" fix-zoom>
    <!-- Room Environment -->
    <!-- Floor -->
    <a-plane position="0 0 -13.455" rotation="-90 0 0" width="20" height="20" material="src: data/textures/carpet/Southern Hemisphere Star Constellation Map Carpet (Tiled).jpg; normalMap: data/textures/carpet/Carpet_Normal (Tiled).jpg; roughnessMap: data/textures/carpet/Carpet_Roughness (Tiled).jpg; aoMap: data/textures/carpet/Carpet_AO (Tiled).jpg; roughness: 1.0; metalness: 0; aoMapIntensity: 1.0; normalScale: 0.5 0.5" scale="0.654 0.654 0.654"></a-plane>
    
    <!-- Ceiling -->
    <a-plane position="0 5 -13.455" rotation="90 180 0" width="20" height="20" material="src: data/textures/carpet/Northern Hemisphere Star Constellation Map Carpet (Tiled).jpg; normalMap: data/textures/carpet/Carpet_Normal (Tiled).jpg; roughnessMap: data/textures/carpet/Carpet_Roughness (Tiled).jpg; aoMap: data/textures/carpet/Carpet_AO (Tiled).jpg; roughness: 1.0; metalness: 0; aoMapIntensity: 1.0; normalScale: 0.5 0.5" scale="0.654 0.654 0.654"></a-plane>
    
    <!-- Back Wall (where table will be) -->
    <a-plane position="0 2.5 -19.991" rotation="0 0 0" width="13.08" height="5" material="src: data/textures/carpet/Carpet_Color (Dark).jpg; normalMap: data/textures/carpet/Carpet012_2K-JPG_NormalGL.jpg; aoMap: data/textures/carpet/Carpet012_2K-JPG_AmbientOcclusion.jpg; roughnessMap: data/textures/carpet/Carpet012_2K-JPG_Roughness.jpg; roughness: 1.0; metalness: 0; aoMapIntensity: 1.0; normalScale: 0.5 0.5; side: double"></a-plane>
    
    <!-- Front Wall -->
    <a-plane position="0 2.5 -6.915" rotation="0 180 0" width="13.08" height="5" material="src: data/textures/carpet/Carpet_Color (Dark).jpg; normalMap: data/textures/carpet/Carpet012_2K-JPG_NormalGL.jpg; aoMap: data/textures/carpet/Carpet012_2K-JPG_AmbientOcclusion.jpg; roughnessMap: data/textures/carpet/Carpet012_2K-JPG_Roughness.jpg; roughness: 1.0; metalness: 0; aoMapIntensity: 1.0; normalScale: 0.5 0.5; side: double"></a-plane>
    
    <!-- Left Wall -->
    <a-plane position="-6.54 2.5 -13.455" rotation="0 90 0" width="13.08" height="5" material="src: data/textures/carpet/Carpet_Color (Dark).jpg; normalMap: data/textures/carpet/Carpet012_2K-JPG_NormalGL.jpg; aoMap: data/textures/carpet/Carpet012_2K-JPG_AmbientOcclusion.jpg; roughnessMap: data/textures/carpet/Carpet012_2K-JPG_Roughness.jpg; roughness: 1.0; metalness: 0; aoMapIntensity: 1.0; normalScale: 0.5 0.5; side: double"></a-plane>
    
    <!-- Star Background Image on Left Wall (between middle and top) -->
    <a-image id="star-background-image" position="-6.53 3.2 -13.455" rotation="0 90 0" width="4" height="2.25" scale="2.5 2.5 2.5" src="data/star_constellations/star_background.jpg" material="side: double"></a-image>
    
    <!-- Frame around Star Background Image -->
    <!-- Top frame (horizontal) -->
    <a-box position="-6.53 4.517 -13.455" rotation="0 90 0" width="10.2" height="0.15" depth="0.1" scale="0.976 1 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
    <!-- Bottom frame (horizontal) -->
    <a-box position="-6.53 1.883 -13.455" rotation="0 90 0" width="10.2" height="0.15" depth="0.1" scale="0.976 1 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
    <!-- Left frame (vertical) -->
    <a-box position="-6.53 3.2 -18.505" rotation="0 90 0" width="0.15" height="5.775" depth="0.1" scale="1 0.482 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
    <!-- Right frame (vertical) -->
    <a-box position="-6.53 3.2 -8.405" rotation="0 90 0" width="0.15" height="5.775" depth="0.1" scale="1 0.482 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
    
    <!-- Right Wall -->
    <a-plane position="6.54 2.5 -13.455" rotation="0 -90 0" width="13.08" height="5" material="src: data/textures/carpet/Carpet_Color (Dark).jpg; normalMap: data/textures/carpet/Carpet012_2K-JPG_NormalGL.jpg; aoMap: data/textures/carpet/Carpet012_2K-JPG_AmbientOcclusion.jpg; roughnessMap: data/textures/carpet/Carpet012_2K-JPG_Roughness.jpg; roughness: 1.0; metalness: 0; aoMapIntensity: 1.0; normalScale: 0.5 0.5; side: double"></a-plane>
    
    <!-- Constellation Blackboard on Right Wall (stars will be created dynamically) -->
    <a-entity id="centaurus-board" position="6.53 2.882 -13.455" rotation="0 -90 0" scale="0.776 0.776 0.776">
      <!-- Blackboard -->
      <a-image id="constellation-drawing-background" position="0 0.018 0" width="4.5" height="3.5" scale="1.797 1.797 1.797" src="data/star_constellations/Southern Star Background.jpg" material="roughness: 0.8; side: double"></a-image>
      
      <!-- Frame around Constellation Drawing Background -->
      <!-- Top frame (horizontal) -->
      <a-box position="0 2.522 0" rotation="0 0 0" width="8.237" height="0.15" depth="0.1" scale="0.982 1 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Bottom frame (horizontal) -->
      <a-box position="0 -2.487 0" rotation="0 0 0" width="8.237" height="0.15" depth="0.1" scale="0.982 1 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Left frame (vertical) -->
      <a-box position="-4.118 0.018 0" rotation="0 0 0" width="0.15" height="6.440" depth="0.1" scale="1 0.8012 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Right frame (vertical) -->
      <a-box position="4.118 0.018 0" rotation="0 0 0" width="0.15" height="6.440" depth="0.1" scale="1 0.8012 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; color: #666666; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      
      <!-- Stars will be created dynamically by JavaScript -->
      
      <!-- Container for dynamically created connection lines -->
      <a-entity id="constellation-lines"></a-entity>
    </a-entity>
    
    <!-- Sky (for outside view) -->
    <a-sky color="#87CEEB"></a-sky>
    
    <!-- Camera (inside room, looking at table) -->
    <a-camera position="0 2.5 -13.455" rotation="0 0 0" camera-bounds>
      <!-- Completion Message UI as A-Frame entity (center of screen) -->
      <a-entity id="completion-message-entity" class="completion-message-entity" visible="false">
        <a-text 
          id="completion-text"
          position="0 0 -0.5" 
          value="" 
          align="center" 
          color="#ffffff" 
          width="1.5"
          font="roboto"
          anchor="center">
        </a-text>
      </a-entity>
    </a-camera>
    
    <!-- Lighting -->
    <a-light type="point" position="0 3.411 -13.445" color="#ffffff" intensity="5" distance="7"></a-light>
    
    <!-- Table inside room (moved forward from wall) -->
    <a-entity id="table" position="0 1.2 -15">
      <!-- Table Top (wider table) -->
      <a-box position="0 0.25 -3.5" width="16" height="0.1" depth="6" scale="0.27 1 0.5" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1; repeat: 2 2"></a-box>
      <!-- Table Legs (at four corners) -->
      <!-- Front Left (leg edge matches table corner) -->
      <a-box position="-2.06 -0.718 -4.9" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Front Right (leg edge matches table corner) -->
      <a-box position="2.06 -0.718 -4.9" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Back Left (leg edge matches table corner) -->
      <a-box position="-2.06 -0.718 -2.1" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Back Right (leg edge matches table corner) -->
      <a-box position="2.06 -0.718 -2.1" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      
      <!-- Solar System on Table (centered, smaller rings) -->
      <a-entity position="0 0.5 -3.5" id="solar-system">
        <!-- Sun (centered on table) -->
        <a-sphere position="0 0 0" radius="0.132" src="data/planet_textures/Sun.jpg" material="emissive: #FFD700; emissiveIntensity: 0.8">
          <a-animation attribute="rotation" to="0 360 0" dur="10000" repeat="indefinite"></a-animation>
        </a-sphere>
        
        <!-- Mercury (Left Side) -->
        <a-sphere data-planet="mercury" data-radius="0.25" data-ring-index="0" class="draggable" position="-1.5 0 -0.75" radius="0.015" src="data/planet_textures/Mercury.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="10000" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="0" data-ring-radius="0.25" position="0 0 0" rotation="-90 0 0" radius-inner="0.25" radius-outer="0.26" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Venus (Left Side) -->
        <a-sphere data-planet="venus" data-radius="0.35" data-ring-index="1" class="draggable" position="-1.5 0 -0.25" radius="0.031" src="data/planet_textures/Venus.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="8000" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="1" data-ring-radius="0.35" position="0 0 0" rotation="-90 0 0" radius-inner="0.35" radius-outer="0.36" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Earth (Left Side) -->
        <a-sphere data-planet="earth" data-radius="0.45" data-ring-index="2" class="draggable" position="-1.5 0 0.25" radius="0.033" src="data/planet_textures/Earth.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="5000" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="2" data-ring-radius="0.45" position="0 0 0" rotation="-90 0 0" radius-inner="0.45" radius-outer="0.46" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Mars (Left Side) -->
        <a-sphere data-planet="mars" data-radius="0.55" data-ring-index="3" class="draggable" position="-1.5 0 0.75" radius="0.021" src="data/planet_textures/Mars.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="6000" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="3" data-ring-radius="0.55" position="0 0 0" rotation="-90 0 0" radius-inner="0.55" radius-outer="0.56" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Jupiter (Right Side) -->
        <a-sphere data-planet="jupiter" data-radius="0.7" data-ring-index="4" class="draggable" position="1.5 0 -0.75" radius="0.0814" src="data/planet_textures/Jupiter.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="3000" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="4" data-ring-radius="0.7" position="0 0 0" rotation="-90 0 0" radius-inner="0.7" radius-outer="0.71" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Saturn with Rings (Right Side) -->
        <a-entity data-planet="saturn" data-radius="0.85" data-ring-index="5" class="draggable" position="1.5 0 -0.25">
          <a-sphere position="0 0 0" radius="0.06" src="data/planet_textures/Saturn.jpg">
            <a-animation attribute="rotation" to="0 360 0" dur="4000" repeat="indefinite"></a-animation>
          </a-sphere>
          <!-- Saturn's Rings - 25 thin rings with varied beige shades, fewer dark ones -->
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.082" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#F5E6D3" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.083" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#E8D5C0" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.085" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#FFF8E7" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.087" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#D2B48C" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.088" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#FDF5E6" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.09" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#C9A882" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.092" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#EDE0D0" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.093" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#E3D0BB" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.095" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#B8956A" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.097" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#FAF0E6" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.099" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#DDC5B0" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.10" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#F0E6D2" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.102" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#C4A37A" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.104" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#D8C0A5" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.105" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#FFF8E7" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.107" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#BF9E72" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.109" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#E8D5C0" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.11" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#CDB48C" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.112" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#F5E6D3" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.114" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#B3905A" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.116" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#D2B48C" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.117" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#FFF8E7" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.119" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#E3D0BB" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.121" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#A0825D" arc="360"></a-torus>
          <a-torus position="0 0 0" rotation="-90 0 0" radius="0.122" radius-tubular="0.003" scale="1 1 0.1" segments-tubular="70" color="#FDF5E6" arc="360"></a-torus>
        </a-entity>
        <a-ring data-ring="5" data-ring-radius="0.85" position="0 0 0" rotation="-90 0 0" radius-inner="0.85" radius-outer="0.86" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Uranus (Right Side) -->
        <a-sphere data-planet="uranus" data-radius="1" data-ring-index="6" class="draggable" position="1.5 0 0.25" radius="0.052" src="data/planet_textures/Uranus.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="5000" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="6" data-ring-radius="1" position="0 0 0" rotation="-90 0 0" radius-inner="1" radius-outer="1.01" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
        
        <!-- Neptune (Right Side) -->
        <a-sphere data-planet="neptune" data-radius="1.15" data-ring-index="7" class="draggable" position="1.5 0 0.75" radius="0.051" src="data/planet_textures/Neptune.jpg">
          <a-animation attribute="rotation" to="0 360 0" dur="5500" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-ring data-ring="7" data-ring-radius="1.15" position="0 0 0" rotation="-90 0 0" radius-inner="1.15" radius-outer="1.16" segments-theta="100" color="#ffffff" opacity="0.8"></a-ring>
      </a-entity>
    </a-entity>
    
    <!-- Table on other side of solar system wall (same size) - along front wall -->
    <a-entity id="table-2" position="0 1.2 -4.915">
      <!-- Table Top (wider table) -->
      <a-box position="0 0.25 -3.5" width="16" height="0.1" depth="6" scale="0.27 1 0.5" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1; repeat: 2 2"></a-box>
      <!-- Table Legs (at four corners) -->
      <!-- Front Left (leg edge matches table corner) -->
      <a-box position="-2.06 -0.718 -4.9" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Front Right (leg edge matches table corner) -->
      <a-box position="2.06 -0.718 -4.9" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Back Left (leg edge matches table corner) -->
      <a-box position="-2.06 -0.718 -2.1" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      <!-- Back Right (leg edge matches table corner) -->
      <a-box position="2.06 -0.718 -2.1" width="0.2" height="1" depth="0.2" scale="1 1.839 1" material="src: data/textures/wood_table/wood_table_worn_diff_2k.jpg; normalMap: data/textures/wood_table/wood_table_worn_nor_gl_2k.jpg; roughnessMap: data/textures/wood_table/wood_table_worn_rough_2k.jpg; aoMap: data/textures/wood_table/wood_table_worn_ao_2k.jpg; roughness: 0.8; metalness: 0.1; aoMapIntensity: 1.0; normalScale: 1 1"></a-box>
      
      <!-- Four Elements Images - horizontally in the middle towards the back -->
      <a-plane position="-1.5 0.31 -3.500" width="0.4" height="0.306" rotation="-90 180 0" scale="2 2 2" src="data/zodiac/four elements/Air.png" material="side: double; transparent: true"></a-plane>
      <a-plane position="-0.5 0.31 -3.500" width="0.4" height="0.306" rotation="-90 180 0" scale="2 2 2" src="data/zodiac/four elements/Earth.png" material="side: double; transparent: true"></a-plane>
      <a-plane position="0.5 0.31 -3.500" width="0.4" height="0.306" rotation="-90 180 0" scale="2 2 2" src="data/zodiac/four elements/Fire.png" material="side: double; transparent: true"></a-plane>
      <a-plane position="1.5 0.31 -3.500" width="0.4" height="0.306" rotation="-90 180 0" scale="2 2 2" src="data/zodiac/four elements/Water.png" material="side: double; transparent: true"></a-plane>
      
      <!-- Four Spheres in front of the images -->
      <!-- Blue sphere for Air -->
      <a-sphere data-sphere="sphere-1" data-element="air" class="draggable-sphere" position="-0.6 0.4 -4.3" radius="0.1" color="#0000FF"></a-sphere>
      <!-- Red sphere for Fire -->
      <a-sphere data-sphere="sphere-2" data-element="fire" class="draggable-sphere" position="-0.2 0.4 -4.3" radius="0.1" color="#FF0000"></a-sphere>
      <!-- Blue sphere for Water -->
      <a-sphere data-sphere="sphere-3" data-element="water" class="draggable-sphere" position="0.2 0.4 -4.3" radius="0.1" color="#0066FF"></a-sphere>
      <!-- Brown sphere for Earth -->
      <a-sphere data-sphere="sphere-4" data-element="earth" class="draggable-sphere" position="0.6 0.4 -4.3" radius="0.1" color="#8B4513"></a-sphere>
    </a-entity>
    
  </a-scene>
  
  <!-- Proximity UI -->
  <button id="proximity-ui" class="proximity-ui hidden" disabled>
    <span class="proximity-text">E Solve Puzzle</span>
  </button>
  
  <!-- Key Message UI -->
  <div id="key-message-ui" class="key-message-ui hidden">
    <span class="key-message-text">Key needed to unlock door</span>
  </div>
  
  <!-- Guide Button (shown in puzzle mode) -->
  <button id="guide-button" class="guide-button hidden">Guide</button>
  
  <!-- Guide Overlay -->
  <div id="guide-overlay" class="guide-overlay hidden">
    <div class="guide-text-container">
      <p id="guide-text" class="guide-text"></p>
    </div>
  </div>
  
  <!-- Intro Overlay -->
  <div id="intro-overlay" class="intro-overlay">
    <div id="intro-title" class="intro-title">CELESTIAL SECRETS</div>
    <div id="intro-story" class="intro-story hidden">
      <p>After decades of studying under a renowned astronomer, you inherit his old manor following his passing. When you step into his private study, you discover a note that reads:</p>
      <div style="height: 3vh;"></div>
      <p><em>"If you are to continue my work, you must first understand it."</em></p>
      <div style="height: 3vh;"></div>
      <p>Before you can react, the door locks behind you. The note continues:</p>
      <div style="height: 3vh;"></div>
      <p><em>"To fully inherit my research and this manor, you must prove that you are worthy. Solve the puzzles in this room to obtain the key and unlock the door. The star lamps will indicate which puzzle you must solve first."</em></p>
    </div>
    <div id="intro-story-2" class="intro-story hidden">
      <p>Your mentor has left you a book of knowledge to guide you. Scan this QR code on another device to open the book. Each page contains information and clues to solve a single puzzle.</p>
      <img id="qr-code" class="qr-code" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://liaimv.github.io/celestial-secrets-hint/" alt="QR Code">
    </div>
    <button id="start-button" class="start-button hidden">NEXT</button>
  </div>
  
  <!-- Controls Overlay -->
  <div id="controls-overlay" class="controls-overlay">
    <div class="controls-container">
      <button id="close-controls" class="close-controls-button">X</button>
      <h2 class="controls-title">CONTROLS</h2>
      <ul class="controls-list">
        <li>WASD to move</li>
        <li>Hold left-click and move the mouse to look</li>
      </ul>
    </div>
  </div>
  
  <script type="module" src="/src/main.js"></script>
  <script>
    // Prevent text dragging
    document.addEventListener('DOMContentLoaded', function() {
      // Prevent dragstart on all elements
      document.addEventListener('dragstart', function(e) {
        if (e.target.tagName === 'A-TEXT' || 
            e.target.classList.contains('proximity-text') ||
            e.target.classList.contains('guide-text') ||
            e.target.classList.contains('intro-title') ||
            e.target.classList.contains('intro-story') ||
            e.target.classList.contains('controls-title') ||
            e.target.classList.contains('key-letter') ||
            e.target.classList.contains('esc-text') ||
            e.target.tagName === 'P' ||
            e.target.tagName === 'SPAN' ||
            e.target.tagName === 'DIV' ||
            e.target.tagName === 'BUTTON' ||
            e.target.tagName === 'LI' ||
            e.target.tagName === 'H1' ||
            e.target.tagName === 'H2' ||
            e.target.tagName === 'H3' ||
            e.target.tagName === 'H4' ||
            e.target.tagName === 'H5' ||
            e.target.tagName === 'H6') {
          e.preventDefault();
          return false;
        }
      }, false);
      
      // Prevent text selection on all elements
      document.addEventListener('selectstart', function(e) {
        e.preventDefault();
        return false;
      }, false);
    });
    
    // Fix zoom issue - register component to fix renderer early
    AFRAME.registerComponent('fix-zoom', {
      init: function() {
        const scene = this.el;
        const fixRendererZoom = () => {
          if (scene.renderer) {
            const renderer = scene.renderer;
            const canvas = renderer.domElement;
            
            // Force pixel ratio to 1 to prevent zoom issues
            renderer.setPixelRatio(1);
            
            // Get actual viewport dimensions
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            // Set renderer size
            renderer.setSize(width, height, false);
            
            // Force canvas CSS to match viewport exactly
            if (canvas) {
              canvas.style.width = width + 'px';
              canvas.style.height = height + 'px';
              canvas.style.maxWidth = '100%';
              canvas.style.maxHeight = '100%';
              canvas.style.transform = 'scale(1)';
              canvas.style.transformOrigin = 'top left';
            }
          }
        };
        
        // Fix immediately
        fixRendererZoom();
        
        // Fix on renderstart
        scene.addEventListener('renderstart', fixRendererZoom);
        
        // Fix on loaded
        scene.addEventListener('loaded', fixRendererZoom);
        
        // Store function globally for resize handler
        window.fixRendererZoom = fixRendererZoom;
      }
    });
    
    // Fix zoom issue and improve texture quality
    const scene = document.querySelector('a-scene');
    
    // Fix renderer function (also available globally)
    function fixRendererZoom() {
      if (scene && scene.renderer) {
        const renderer = scene.renderer;
        const canvas = renderer.domElement;
        
        // Force pixel ratio to 1 to prevent zoom issues
        renderer.setPixelRatio(1);
        
        // Get actual viewport dimensions
        const width = window.innerWidth;
        const height = window.innerHeight;
        
        // Set renderer size
        renderer.setSize(width, height, false);
        
        // Force canvas CSS to match viewport exactly
        if (canvas) {
          canvas.style.width = width + 'px';
          canvas.style.height = height + 'px';
          canvas.style.maxWidth = '100%';
          canvas.style.maxHeight = '100%';
          canvas.style.transform = 'scale(1)';
          canvas.style.transformOrigin = 'top left';
        }
      }
    }
    
    // Store globally for resize handler
    window.fixRendererZoom = fixRendererZoom;
    
    // Also fix on renderstart (when renderer is definitely ready)
    scene.addEventListener('renderstart', function() {
      fixRendererZoom();
      
      const THREE = AFRAME.THREE;
      const renderer = scene.renderer;
      
      // Update all existing materials and textures
      function improveTextureQuality() {
        scene.object3D.traverse(function(object) {
          if (object.material) {
            const materials = Array.isArray(object.material) ? object.material : [object.material];
            materials.forEach(function(material) {
              if (material.map) {
                material.map.minFilter = THREE.LinearMipmapLinearFilter;
                material.map.magFilter = THREE.LinearFilter;
                material.map.generateMipmaps = true;
                if (renderer && renderer.capabilities && renderer.capabilities.getMaxAnisotropy) {
                  material.map.anisotropy = Math.min(16, renderer.capabilities.getMaxAnisotropy());
                }
                material.map.needsUpdate = true;
              }
            });
          }
        });
      }
      
      // Improve textures immediately
      improveTextureQuality();
      
      // Also improve textures after a short delay to catch any late-loading textures
      setTimeout(improveTextureQuality, 1000);
      setTimeout(improveTextureQuality, 3000);
    });
    
    // Handle window resize to maintain correct aspect ratio
    window.addEventListener('resize', function() {
      if (window.fixRendererZoom) {
        window.fixRendererZoom();
      }
    });
    
    // Also fix after delays to catch any late initialization
    setTimeout(fixRendererZoom, 100);
    setTimeout(fixRendererZoom, 500);
    setTimeout(fixRendererZoom, 1000);
    setTimeout(fixRendererZoom, 2000);
  </script>
</body>
</html>

